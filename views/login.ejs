<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('./partials/head'); %>
  </head>
  <body>
    <%- include('./partials/header'); %>
    <div class="container">
      <h1>Login Page</h1>
      <form>
        <div class="error" style="background-color: red;"></div>
        <br />
        <label for="username">Username</label><br />
        <input type="text" id="username" required /><br />
        <label for="password">Password</label><br />
        <input type="password" id="password" required /><br />
        <input type="submit" value="login" /><br />
      </form>
      <a href="/register">Don't have an accout? Register</a>
    </div>
    <script>
        const form = document.querySelector('form')
        const username = document.querySelector('#username')
        const password = document.querySelector('#password')
        const display = document.querySelector('.error')
        form.addEventListener('submit', async (e) => {
          e.preventDefault()
          console.log("submitting form");
          console.log($("#username").val());
          console.log($("#password").val());
          e.preventDefault()
          //  display.textContent = ''
         $.ajax({
            type: "POST",
            url: '/user/login',
            data:{
              username: $("#username").val(),
              password: $("#password").val()
            },
            success: function(response){
                console.log(response);
                window.location.href ='/admin';
            },   error: function(error) {
              console.log("ERROR");
              console.log(error.responseJSON.message);
            }
        });
          
          })
        </script>
  </body>
</html>